# 常系数线性微分方程的特解
## 一. 导言
本节主要介绍常系数线性微分方程的求解方法。


## 二.  常系数线性微分方程的求解
描述LTI系统的常系数线性微分方程的一般形式为：

$$a_n\frac{d^n}{dt^n}r(t)+a_{n-1}\frac{d^{n-1}}{dt^{n-1}}r(t)+...+a_{1}\frac{d}{dt}r(t)+a_0=b_m\frac{d^m}{dt^m}e(t)+b_{m-1}\frac{d^{m-1}}{dt^{m-1}}e(t)+...+b_{1}\frac{d}{dt}e(t)+b_0$$

其中，$r(t)$为系统响应，$e(t)$为激励信号。我们将响应部分的函数及各阶导数置于方程左侧，称这部分为微分方程的“齐次项”，将激励部分的函数及其各阶导数置于方程右侧，称这部分为微分方程的“非齐次项”。
### 2.1  回顾齐次解部分
上述常系数线性微分方程对应的齐次方程为：

$$a_n\frac{d^n}{dt^n}r(t)+a_{n-1}\frac{d^{n-1}}{dt^{n-1}}r(t)+...+a_{1}\frac{d}{dt}r(t)+a_0=0$$

这里，我们直接给出该方程的特征根与齐次解的对应关系：

|特征根的情况|对应齐次解|
|--|--|
|$\lambda_1,\lambda_2, ...\lambda_n$等$n$个互不相等的实根|$e^{\lambda_{1}t},e^{\lambda_{2}t},..., e^{\lambda_{n}t}$|
| $\lambda_1 = \lambda_2=...\lambda_k$等$k$重实根 |$e^{\lambda_{1}t},te^{\lambda_{1}t},..., t^{k-1}e^{\lambda_{1}t}$|
|$\sigma \pm j\omega$(复数根必定以共轭形式出现)|$e^{\sigma t}\cos(\omega t), e^{\sigma t}\sin(\omega t)$|
|$k$重成对共轭复根$\sigma \pm j\omega$|$[1,t,t^2,..., t^{k-1}][e^{\sigma t}\cos(\omega t), e^{\sigma t}\sin(\omega t)]$|

其中$[1,t,t^2,..., t^{k-1}][e^{\sigma t}\cos(\omega t), e^{\sigma t}\sin(\omega t)]$表示$e^{\sigma t}\cos(\omega t), e^{\sigma t}\sin(\omega t),te^{\sigma t}\cos(\omega t), te^{\sigma t}\sin(\omega t),...,t^{k-1}e^{\sigma t}\cos(\omega t), t^{k-1}e^{\sigma t}\sin(\omega t)$

以及关于求解齐次方程的四条重要结论：
**结论一：** 任意一个特征根$\lambda$就对应着齐次方程的一个解$e^{\lambda t}$
**结论二：** 如果线性齐次微分方程的特征根$\lambda$的代数重数为$k$，那么这个线性齐次微分方程的解中，必然包含：$e^{-\lambda t}, \quad te^{-\lambda t},\quad t^2e^{-\lambda t},...,\quad t^{k-1}e^{-\lambda t}$，而且它们是线性无关的。
**结论三：** 如果特征方程存在成对共轭复数根$\sigma \pm j\omega$，那么对应齐次解：$e^{\sigma t}\cos(\omega t), e^{\sigma t}\sin(\omega t)$。
**结论四：** 常系数线性齐次微分方程中线性无关解的个数，等于原微分方程的阶数。<br>

### 2.2  常系数线性微分方程——特解
本节的终极目标就是给出完整的求解常系数线性微分方程的方法。在之前已经介绍过齐次解的求解方法，根据线性代数的知识，任意一个线性方程的解的情况为:
完全解=齐次解+特解  <br>

这里我们考虑的并不是线性方程，而是线性**微分**方程，但是道理是一样。我们只需要找到一个特解，结合齐次解，就能完全解出常系数线性微分方程。
那么，问题是：**特解怎么找呢？**
之前我们在求解齐次方程的时候，将非齐次项设为0，得到了齐次解。那么，为了获得特解，我们需要尽可能得从非齐次项上获取信息。
我们同样从案例出发，先看一个简单的常系数线性微分方程：

$$\frac{d^2}{dt^2}r(t)+3\frac{d}{dt}r(t)+2r(t)=8 \quad(1)$$

很容易求出该方程的齐次解部分：

$$r _1(t)=e^{-t}, r_2(t)=e^{-2t}$$

那么特解是多少呢？我们注意，非齐次项是一个常数，那我们不妨猜一猜：
假设$r(t)=4$，那么方程：

$$\frac{d^2}{dt^2}r(t)+3\frac{d}{dt}r(t)+2r(t)=8$$

的左侧前两项为0，第三项为8，刚好等于右侧。
所以，$r(t)=4$就是这里的特解，我们可以观察到，无论齐次解的组合系数$c_1,  c_2$取多少，都无法使得齐次解部分恒等于4，那么$r(t)=4$这一结果就是方程的**特解**，为什么称作“**特**解”呢？因为与齐次解不同，齐次解仅仅与微分方程的齐次项的结构有关，而特解还与**非齐次项**有关。
因此，接下来，我们将讨论的是，特解的形式与非齐次项形式的关系。
 
### 2.2.1 非齐次项为常数$B$<a id="chapter-221"></a>
这一点我们在上面的案例中已经讨论过了，这里直接给出**基本结论一**：
**如果方程的齐次项为常数$B$，那么特解也必定是常数**
那么如何求得这个常数呢？刚刚到案例中我们毫无逻辑的猜出$r(t)=4$，发现代回原方程，发现刚好满足。现在，我们如果已经知道了特解为常数，那么我们只需要设出该常数，代回原方程就能求出。
其他各种情况也是一样的，我们只需要根据非齐次项的形式，猜出**特解的形式**，然后再将该特解代回原方程，求出该特解中的系数，就能确定特解。
相信看到这里的读者必定很疑惑，证明一会儿又是非齐次项，一会儿又是特解，一会儿又是系数。但不用担心，通过下面的例子演示，读者就能完全理解**求特解**这个过程。
### 2.2.2 非齐次项为$P_m(t)$<a id="chapter-222"></a>
其中$P_m(t)$为关于$t$的$m$次多项式，例如

$$a_mt^m+a_{m-1}t^{m-1}+...+a_1t+a_0$$

我们同样不加证明的给出结论（**基本结论二**）：
**非齐次项为$P_m(t)$时，特解应该设为:$r(t)=Q_m(t)$，其中$Q_m(t)$是关于$t$的$m$ 次多项式：$b_mt^m+b_{m-1}t^{m-1}+...+b_1t+b_0$**
至于为什么要这么设，请读者先自行思索。如果思考过后毫无头绪，请看下面提示：
> 提示：最高次项对齐
 这里的系数$b_m～b_0$，就是我们需要通过代回原方程求解的量。
 以一道例题为例：

 $$\frac{d^2}{dt^2}r(t)+3\frac{d}{dt}r(t)+2r(t)=t^3+t-3  \quad(2) $$

 右侧非齐次项为关于$t$的三次多项式，因此，特解应该也是关于$t$的三次多项式，我们设为：

 $$r(t)=b_3t^3+b_2t^2+b_1t+b_0$$

 回代原方程，有：

 $$\frac{d}{dt}r(t)=3b_3t^2+2b_2t+b_1$$

 $$\frac{d^2}{dt^2}r(t)=6b_3t+2b_2$$

 因此有：

 $$2b_3t^3+(2b_2+9b_3)t^2+(2b_1+6b_2+6b_3)t+(2b_0+3b_1+2b_2)=t^3+t-3$$

 解得：

 $$b_3=\frac{1}{2},b_2=-\frac{9}{2},b_1=\frac{25}{2},b_0=-\frac{63}{4}$$

 因此特解为：

 $$r(t)=\frac{1}{2}t^3-\frac{9}{2}t^2+\frac{25}{2}t-\frac{63}{4}$$

 结合齐次解：

 $$r(t)=c_1e^{-t}+c_2e^{-2t}$$

 因此该常系数线性微分方程的完全解为：

  $$r(t)=c_1e^{-t}+c_2e^{-2t}+\frac{1}{2}t^3-\frac{9}{2}t^2+\frac{25}{2}t-\frac{63}{4}   $$
  
  > 可能会有读者有疑惑，为什么我们能够通过回代原方程求出特解的系数（例如上例中的$b_m～b_0$），但是却无法求出齐次解的系数（例如上例中的$c_1, c_2$）。
  > 原因就在于，齐次方程的解是有无限多的。这些解都是由几个最基本的解进行线性组合构成的。
  > 在实际的物理系统中，方程的解必定是确定的，即c_1,c_2也是能够通过其他外加条件确定的。读者可以想一想所谓的“外加条件”到底是什么？
  
### 2.2.3 非齐次项为$P_m(t)$：特殊情况<a id="chapter-223"></a>
 
经过2.2.2的例子，相信读者已经理解了整个求解的过程。那我们再来看一个例子：

$$\frac{d^2}{dt^2}r(t)+3\frac{d}{dt}r(t)=t^3   \quad(3)    $$

那根据基本结论二，非齐次项依旧是一个3次多项式，那么我们依旧设特解为：

$$r(t)=b_3t^3+b_2t^2+b_1t+b_0$$

回代原方程，有：
$$9b_3t^2+(6b_2+6b_3)t+(3b_1+2b_2)=t^3$$

**读者一眼就能看出问题，这个方程是无解的，因为最高次没有对齐！**
为什么会出现这种情况呢？我们对比2.2.1中，将特解回代入原方程后得到的方程：

$$2b_3t^3+(2b_2+9b_3)t^2+(2b_1+6b_2+6b_3)t+(2b_0+3b_1+2b_2)=t^3+t-3$$

可以发现，方程$9b_3t^2+(6b_2+6b_3)t+(3b_1+2b_2)=t^3$中完全看不到$b_0$！
 
**更本质一点，原因就是：方程(3)中没有原函数$r(t)$**
换句话说，**方程(3)的特征根中，有一个是0！**
这两个说法是等价的。请读者自行思考这是为什么。
所以，我们的基本结论二，其实是有适用条件的，我们必须对其进行修正，为了兼容上面那个例子。
针对基本结论二，我们有两种修正方式：

#### 2.2.3.1 基本结论二的修正：方式一
我们观察到方程(3)中没有原函数，因此这个方程实际上等价于：

$$\frac{d}{dt}g(t)+3g(t)=t^3 \quad \quad(3-1)$$

其中，$g(t)=\frac{d}{dt}r(t)$
只要解出$g(t)$，我们就能解出$r(t)$，只需要一次积分即可。
方程(3-1)，完全适用于基本结论二，不会出现方程(3)的特殊情况。
因此，基本结论二可以修正为：
**当0不是特征方程的根时，非齐次项为$P_m(t)$时，特解应该设为:$r(t)=Q_m(t)$，其中$Q_m(t)$是关于$t$的$m$ 次多项式：$b_mt^m+b_{m-1}t^{m-1}+...+b_1t+b_0$。当0是特征方程的根时，需对原微分方程降阶后，再进行求解。**

##### 2.2.3.2 基本结论二的修正：方式二
事实上，在求解微分方程时，我们并不希望对原函数进行先求导再积分这样繁琐的步骤。我们希望基本结论二能被修正成这样，即即便特征根含0，仍能够直接给出特解形式。
怎么做呢，我们再回到之前的分析：
当我们设

$$r(t)=b_3t^3+b_2t^2+b_1t+b_0$$

时，有：

$$9b_3t^2+(6b_2+6b_3)t+(3b_1+2b_2)=t^3$$

既然$r(t)$项的缺失导致最高次项$t^3$无法匹配，那我们不放在设出$r(t)$时，手动添加一项更高次项——$t^4$，这样的话，有：

$$r(t)=b_4t^4+b_3t^3+b_2t^2+b_1t+b_0$$

代入原方程，有：

$$12b_4t^3+(12b_4+9b_3)t^2+(6b_2+6b_3)t+(3b_1+2b_2)=t^3$$

我们先不去解这个方程，我们先观察，这个方程还有没有奇怪的地方？
**——没有$b_0$**
这也是因为原微分方程中缺少原函数项导致原函数中的常数项再求导后消失，因此，我们即便设出该常数，也不可求出来，因为特解根本不含常数项（当然也可以说常数项为0）。无论基于哪种情况，我们在设出特解的时候，都不必考虑常数项$b_0$，因此，特解实际上应该设为：

$$r(t)=b_4t^4+b_3t^3+b_2t^2+b_1t$$

更一般的说法是，在这种情况下，我们说，特解可以设为：

$$r(t)=t(b_4t^3+b_3t^2+b_2t+b_1)=tQ_3(t)$$

其中，$Q_3(t)$是关于$t$的三次多项式。
因此，我们便基于上面的分析，得到了基本结论二的这样的修正：
**当0不是特征方程的根时，非齐次项为$P_m(t)$时，特解应该设为:$r(t)=Q_m(t)$，其中$Q_m(t)$是关于$t$的$m$ 次多项式：$b_mt^m+b_{m-1}t^{m-1}+...+b_1t+b_0$。当0是特征方程的根时，特解应该设为:$r(t)=tQ_m(t)$**
  
#### 2.2.3.3 基本结论二的正确修正<a id="chapter-2223"></a>
事实上，2.2.2.1和2.2.2.2的两种方式，都还没有考虑到更一般的情况，也就是说，在某些情况下，还是会出现不适用——**这些情况就是特征根中0的代数重数大于1的情况**。在这里，我们直接给出基本结论二的正确修正：
**基本结论二：若非齐次项为$P_m(t)$，当0不是特征方程的根时，特解应该设为:$r(t)=Q_m(t)$，其中$Q_m(t)$是关于$t$的$m$ 次多项式：$b_mt^m+b_{m-1}t^{m-1}+...+b_1t+b_0$。当0是特征方程的$k$重特征根时，特解应该设为:$r(t)=t^kQ_m(t)$**

为什么会用$t^k$倍乘呢？我们可以这样理解：
如果方程的特征根不止含一个零，那么当我们考虑修正方式一时，那我们就要考虑**多次积分**，这样的话，特解中的$t$低次幂就会消失的越来越多，同时会由更高次幂来补全。这一点从修正方式二中可以观察的更为直观。

### 2.2.4 非齐次项为$e^{\lambda t}$<a id="chapter-224"></a>
我们不加证明的直接给出结论（饶是如此，相信读者想要理解这个结论，也是非常直观和容易的）：
**基本结论三(pre): 当非齐次项为$e^{\lambda t}$时，特解应该设为：$b e^{\lambda t}$**
 
举例：

$$\frac{d^2}{dt^2}r(t)+3\frac{d}{dt}r(t)+2r(t)=e^t  \quad \quad (4-1) $$

我们直接应用基本结论三(pre)，设特解：$r(t)=be^t$
代回方程(4-1)得到：

$$6be^t=e^t$$

得：

$$r(t)=\frac{1}{6}e^t$$

我们再来看一道例子：

$$\frac{d^2}{dt^2}r(t)+3\frac{d}{dt}r(t)+2r(t)=e^{-t}  \quad \quad (4-2) $$

我们依照结论，设出特解：$r(t)=be^{-t}$
代入原方程，得到:

$$0=e^{-t}$$

这看起来是一件很诡异的事，但其实是理所应当的，为什么呢？
>因为$e^{-t}$是齐次解！所以代入方程(4-2)理所应当左侧为零。
 
所以我们得出了什么样的结论呢？也就是说：
**当非齐次项$e^{\lambda t}$中的$\lambda$为方程特征根时，特解不能简单设为:$be^{\lambda t}$，因为这会与齐次解冲突**，
那么该怎么办呢？难道说这种方程没有特解吗？
**当然不是，既然有齐次项(齐次项不为0)，那么必然会存在特解，这是肯定的。**
那么应该怎么设呢？
我们不妨令：

$$r(t)=v(t)e^{-t}$$

代入方程(4-2)，得到：

$$v''(t)e^{-t}=0$$

答案很明朗了，我们只需要解出

$$v''(t)=0$$

即可，很显然，$v(t)=bt+a$，其中$A$和$B$是待定系数，同时，又由于$ae^{-t}$代回方程后，又会成为齐次解，故，实际上有效的特解应该是：

$$r(t)=bte^{-t}$$
这样，代回原方程之后，就能成立，并且不会与齐次解冲突。
**更进一步的，当非齐次项$e^{\lambda t}$中的$\lambda$为方程的$k$特征根时，情况也会产生一些变化**，并且，可以告诉读者的是，这种变化与[2.2.2.3](#chapter-2223)中的变化完全相同，因此，我们直接给出基本结论三的正确形式：
**基本结论三: 当非齐次项为$e^{\lambda t}$时，并且$\lambda$为方程的$k$重特征根时(若不是特征根，则$k=0$)，特解应该设为：$bt^ke^{\lambda t}$**

#### 2.2.5 非齐次项为$P_m(t)e^{\lambda t}$
有了[2.2.2](#chapter-222)~[2.2.4](#chapter-224)的求解经验，这里我们直接给出**基本结论四**：
**当非齐次项为$P_{m}(t)e^{\lambda t}$时，并且$\lambda$为方程的$k$重特征根时(若不是特征根，则$k=0$)，特解应该设为：$t^kQ_m(t)e^{\lambda t}$,$\quad$其中$Q_m(t)$是关于$t$的$m$ 次多项式：$b_mt^m+b_{m-1}t^{m-1}+...+b_1t+b_0$。**
这里就不在给读者分析了，如果读者感到疑惑，不妨假设一些例子动手做做。
**比较有意思的是，当$\lambda=0$时，基本结论四还原为[基本结论二](#chapter-2223)**，这是一个很重要的结论，是本文最后给出**综合定理**的基础之一。

接下来，我们在给出两个情况及其对应结论，就可以解决常系数线性微分方程特解求解的所有情况。同样，我们不再给出证明，只是稍微的提示一下，请读者自行思考(~~其实是实在没有时间写了~~，阔咩纳塞🥺🥺🥺)。
#### 2.2.6 非齐次项为$P_m(t)\cos{\omega t}$或$P_m(t)\sin{\omega t}$
**基本结论五：非齐次项为$P_m(t)\cos{\omega t}$或$P_m(t)\sin{\omega t}$时，并且$\pm j\omega$为方程的$k$重特征根时(若不是特征根，则$k=0$)，特解设为：$t^k[P_m(t)\cos{\omega t}+R_m(t)\sin{\omega t}]$，其中$Q_m(t)$和$R_m(t)$都是关于$t$的$m$ 次多项式**
在基本结论中，应用欧拉公式：

$$e^{jt}=\cos{t}+j\sin{t}$$

可以直接得出基本结论五。

#### 2.2.7 非齐次项为$P_m(t)\cdot \cos{\omega t}\cdot e^{\sigma t}$或$P_m(t)\cdot \sin{\omega t}\cdot e^{\sigma t}$
**基本结论六：非齐次项为$P_m(t)\cdot \cos{\omega t}\cdot e^{\sigma t}$或$P_m(t)\cdot \sin{\omega t}\cdot e^{\sigma t}$时，并且$\sigma \pm j\omega$为方程的$k$重特征根时(若不是特征根，则$k=0$)，特解设为：$t^ke^{\sigma t}[P_m(t)\cos{\omega t}+R_m(t)\sin{\omega t}]$，其中$Q_m(t)$和$R_m(t)$都是关于$t$的$m$ 次多项式**

至此，常系数线性微分方程，常见的非齐次项形式以及特解设法，均全部给大家介绍完毕

## 三.  总结
### 3.1 基本结论集
本文的所有核心知识点，全部总结在上述各种“**基本结论**”字样中，这里再次给大家列出：
**(1) 基本结论一**：如果方程的齐次项为常数$B$，并且0不是方程特征根时，特解也必定是常数
**(2) 基本结论二**：若非齐次项为$P_m(t)$，当0不是特征方程的根时，特解应该设为:$r(t)=Q_m(t)$，其中$Q_m(t)$是关于$t$的$m$ 次多项式：$b_mt^m+b_{m-1}t^{m-1}+...+b_1t+b_0$。当0是特征方程的$k$重特征根时，特解应该设为:$r(t)=t^kQ_m(t)$
**(3) 基本结论三**：当非齐次项为$e^{\lambda t}$时，并且$\lambda$为方程的$k$重特征根时(若不是特征根，则$k=0$)，特解应该设为：$bt^ke^{\lambda t}$
**(4) 基本结论四**：当非齐次项为$P_{m}(t)e^{\lambda t}$时，并且$\lambda$为方程的$k$重特征根时(若不是特征根，则$k=0$)，特解应该设为：$t^kQ_m(t)e^{\lambda t}$,$\quad$其中$Q_m(t)$是关于$t$的$m$ 次多项式：$b_mt^m+b_{m-1}t^{m-1}+...+b_1t+b_0$。
**(5) 基本结论五**：非齐次项为$P_m(t)\cos{\omega t}$或$P_m(t)\sin{\omega t}$时，并且$\pm j\omega$为方程的$k$重特征根时(若不是特征根，则$k=0$)，特解设为：$t^k[P_m(t)\cos{\omega t}+R_m(t)\sin{\omega t}]$，其中$Q_m(t)$和$R_m(t)$都是关于$t$的$m$ 次多项式
**(6) 基本结论六**：非齐次项为$P_m(t)\cdot \cos{\omega t}\cdot e^{\sigma t}$或$P_m(t)\cdot \sin{\omega t}\cdot e^{\sigma t}$时，并且$\sigma \pm j\omega$为方程的$k$重特征根时(若不是特征根，则$k=0$)，特解设为：$t^ke^{\sigma t}[P_m(t)\cos{\omega t}+R_m(t)\sin{\omega t}]$，其中$Q_m(t)$和$R_m(t)$都是关于$t$的$m$ 次多项式


### 3.2 综合定理
前文提到过，对于本文分析的所有请况，实际上有一个**综合定理**存在，其实，这个结论就是：
基本结论六！
**综合定理**：非齐次项为$P_m(t)\cdot \cos{\omega t}\cdot e^{\sigma t}$或$P_m(t)\cdot \sin{\omega t}\cdot e^{\sigma t}$时，并且$\sigma \pm j\omega$为方程的$k$重特征根时(若不是特征根，则$k=0$)，特解设为：$t^ke^{\sigma t}[P_m(t)\cos{\omega t}+R_m(t)\sin{\omega t}]$，其中$Q_m(t)$和$R_m(t)$都是关于$t$的$m$ 次多项式
**本文给出的所有案例，所有的分析，所有的基本结论都可以在综合定理中找到！**
为什么呢？请读者看以下分析:
(1) 当$m=0,\sigma = 0,\omega=0$时，综合定理还原为**基本结论一**；
(2) 当$\sigma = 0,\omega=0$时，综合定理还原为**基本结论二**；
(3) 当$m=0,\omega=0$时，综合定理还原为**基本结论三**；
(4) 当$\omega=0$时，综合定理还原为**基本结论四**；
(5) 当$\sigma=0$时，综合定理还原为**基本结论五**。

#### 3.3 非齐次项——特解对照表

|非齐次项|特征根，重数|特解|
|--|--|--|
|常数$B$|0,0|常数$b$|
| $P_m(t)$|0,$k$|$t^kQ_m(t)$|
|$e^{\lambda t}$|$\lambda, k$|$bt^ke^{\lambda t}$|
|$P_{m}(t)e^{\lambda t}$|$\lambda, k$|$t^kQ_m(t)e^{\lambda t}$|
|$P_m(t)\cos{\omega t}$或$P_m(t)\sin{\omega t}$|$\pm j\omega,k$|$t^k[P_m(t)\cos{\omega t}+R_m(t)\sin{\omega t}]$|
|$P_m(t)\cdot \cos{\omega t}\cdot e^{\sigma t}$或$P_m(t)\cdot \sin{\omega t}\cdot e^{\sigma t}$|$\sigma \pm j\omega,k$|$t^ke^{\sigma t}[P_m(t)\cos{\omega t}+R_m(t)\sin{\omega t}]$|



