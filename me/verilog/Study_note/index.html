
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="SmlCoke">
      
      
        <link rel="canonical" href="https://smlcoke.com/me/verilog/Study_note/">
      
      
        <link rel="prev" href="../../DIC/Glossary/">
      
      
        <link rel="next" href="../../../ml/Basic/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>Verilog HDL 基础 - SmlCoke Home</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css?v=20260224">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#verilog-hdl" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="SmlCoke Home" class="md-header__button md-logo" aria-label="SmlCoke Home" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SmlCoke Home
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Verilog HDL 基础
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../blog/" class="md-tabs__link">
        
  
  
    
  
  博客

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  微电子

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../ml/Basic/" class="md-tabs__link">
          
  
  
    
  
  机器学习

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../ml/CV/" class="md-tabs__link">
          
  
  
    
  
  计算机视觉

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../rust/notes/Study/" class="md-tabs__link">
          
  
  
    
  
  Rust

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="SmlCoke Home" class="md-nav__button md-logo" aria-label="SmlCoke Home" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SmlCoke Home
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    首页
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    博客
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    微电子
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    微电子
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    信号与系统
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DIC/Glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    数字芯片设计术语和流程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Verilog HDL 基础
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Verilog HDL 基础
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#verilog" class="md-nav__link">
    <span class="md-ellipsis">
      
        一、Verilog基础
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、Verilog基础">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 标识符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-reg" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 reg相关问题
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-parameter" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 parameter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.3 parameter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用示例
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#paramter" class="md-nav__link">
    <span class="md-ellipsis">
      
        paramter 参数定义的语法：
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameter" class="md-nav__link">
    <span class="md-ellipsis">
      
        在例化时重载parameter
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-define" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.4 `define
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.4 `define">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        示例
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.5 值
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.6 线网类型
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.7 寄存器类型
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.8 位宽
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#19" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.9 存储器语法
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#110" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.10 变量的符号
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#111" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.11 位选择与连接运算符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.12 运算符
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.12 运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-" class="md-nav__link">
    <span class="md-ellipsis">
      
        ① 算数运算符： * ， /， +， - ， %
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        ② 关系操作符 &lt;, &lt;=, &gt;, &gt;=**
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        ③ 逻辑操作符 &amp;&amp;, ||, !
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      
        ④ 相等操作符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⑤ 位运算
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⑥ 归约运算符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⑦ 移位运算符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⑧ 条件运算符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⑨ 操作符优先级
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verilog_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        二、Verilog：组合逻辑与行为建模
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、Verilog：组合逻辑与行为建模">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 数据流模型
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 行为级模型
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 行为级模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.1 过程结构
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.2 过程块中的赋值
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#223" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.3 过程块中的分支结构
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#224" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.4 过程块中的循环结构
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        三、时序逻辑电路设计基础
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testbench" class="md-nav__link">
    <span class="md-ellipsis">
      
        四、模块例化与testbench设计
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="四、模块例化与testbench设计">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 模块例化注意事项
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-testbench" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Testbench设计
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Testbench设计">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#423" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2.3 循环激励
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#424" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2.4 存储器激励
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#525-testbench" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.5 Testbench中的常见系统函数
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        五、状态机设计
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="五、状态机设计">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 状态机的分类
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 设计步骤
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 两段式经典状态机设计（无输出）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-next_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 next_state的初始值：
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5 状态的编码方式
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.5 状态的编码方式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        方法1. 普通二进制编码
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        方法2. 独热码
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        方法3. 格雷码
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#56" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6 考虑输出的状态设计
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.6 考虑输出的状态设计">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        常见输出方式
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#57" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.7 三段式经典状态机设计（有输出）
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        六、文件读写
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="六、文件读写">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        指定地址的文件读操作
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="指定地址的文件读操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        文件格式说明
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        文件输出
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      
        七、任务
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="七、任务">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      
        Task的定义
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Task的调用
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      
        注意事项
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      
        示例
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      
        八、函数
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="八、函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function" class="md-nav__link">
    <span class="md-ellipsis">
      
        function的定义
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      
        注意事项
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      
        函数的调用
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      
        函数应用举例
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      
        函数与任务的特点
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verilog_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        九、Verilog可综合语法
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verilog_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        十、Verilog代码编写常见问题
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../ml/Basic/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    机器学习
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    机器学习
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/Basic/ch1_Full_Connected_NN/ch1_%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E4%B8%8E%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    全连接神经网络
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/Basic/ch2_Optimization/ch2_2_Optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    优化
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/Basic/ch3_CNN/ch3_CNN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CNN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/Basic/ch4_Self_Attention/ch4_self_attention%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Self-Attention
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/Basic/ch5_Transformer/ch5_transformer%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transformer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../ml/CV/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    计算机视觉
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    计算机视觉
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/CV/ResNet/notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ResNet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/CV/DenseNet/notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DenseNet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/CV/YOLO/YOLO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    YOLO v1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/CV/YOLO/YOLOv2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    YOLO v2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/CV/YOLO/YOLOv3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    YOLO v3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/CV/VIT/ViT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ViT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ml/CV/PFLD/PFLD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PFLD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Rust
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Rust
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rust/notes/Study/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rust 学习笔记
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rust/crypto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rust 加密/解密在线工具
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#verilog" class="md-nav__link">
    <span class="md-ellipsis">
      
        一、Verilog基础
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、Verilog基础">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 标识符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-reg" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 reg相关问题
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-parameter" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 parameter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.3 parameter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用示例
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#paramter" class="md-nav__link">
    <span class="md-ellipsis">
      
        paramter 参数定义的语法：
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameter" class="md-nav__link">
    <span class="md-ellipsis">
      
        在例化时重载parameter
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-define" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.4 `define
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.4 `define">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        示例
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.5 值
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.6 线网类型
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.7 寄存器类型
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.8 位宽
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#19" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.9 存储器语法
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#110" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.10 变量的符号
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#111" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.11 位选择与连接运算符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.12 运算符
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.12 运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-" class="md-nav__link">
    <span class="md-ellipsis">
      
        ① 算数运算符： * ， /， +， - ， %
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        ② 关系操作符 &lt;, &lt;=, &gt;, &gt;=**
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        ③ 逻辑操作符 &amp;&amp;, ||, !
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      
        ④ 相等操作符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⑤ 位运算
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⑥ 归约运算符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⑦ 移位运算符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⑧ 条件运算符
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⑨ 操作符优先级
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verilog_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        二、Verilog：组合逻辑与行为建模
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、Verilog：组合逻辑与行为建模">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 数据流模型
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 行为级模型
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 行为级模型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.1 过程结构
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.2 过程块中的赋值
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#223" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.3 过程块中的分支结构
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#224" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2.4 过程块中的循环结构
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        三、时序逻辑电路设计基础
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testbench" class="md-nav__link">
    <span class="md-ellipsis">
      
        四、模块例化与testbench设计
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="四、模块例化与testbench设计">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 模块例化注意事项
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-testbench" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Testbench设计
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Testbench设计">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#423" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2.3 循环激励
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#424" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2.4 存储器激励
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#525-testbench" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.5 Testbench中的常见系统函数
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        五、状态机设计
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="五、状态机设计">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 状态机的分类
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 设计步骤
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 两段式经典状态机设计（无输出）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-next_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 next_state的初始值：
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5 状态的编码方式
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.5 状态的编码方式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        方法1. 普通二进制编码
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        方法2. 独热码
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        方法3. 格雷码
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#56" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6 考虑输出的状态设计
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.6 考虑输出的状态设计">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        常见输出方式
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#57" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.7 三段式经典状态机设计（有输出）
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        六、文件读写
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="六、文件读写">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        指定地址的文件读操作
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="指定地址的文件读操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        文件格式说明
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        文件输出
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      
        七、任务
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="七、任务">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      
        Task的定义
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Task的调用
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      
        注意事项
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      
        示例
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      
        八、函数
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="八、函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#function" class="md-nav__link">
    <span class="md-ellipsis">
      
        function的定义
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      
        注意事项
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      
        函数的调用
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      
        函数应用举例
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      
        函数与任务的特点
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verilog_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        九、Verilog可综合语法
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verilog_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        十、Verilog代码编写常见问题
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="verilog-hdl">Verilog HDL 学习笔记</h1>
<h2 id="verilog">一、Verilog基础</h2>
<h3 id="11">1.1 标识符</h3>
<p>标识符是任意字母、数字、$、_的组合。<br />
标识符第一个字符必须是==字母==或者_<br />
<mark>保留字都是小写的</mark></p>
<h3 id="12-reg">1.2 reg相关问题</h3>
<p><strong>在一个模块中</strong><br><br />
wire可以被定义为输入和输出，reg只能被定义为输出， 不能被定义为输入<br><br />
原因：<strong>reg的改变受一定条件控制，例如时钟</strong>，不能直接对reg类型变量赋值<br></p>
<p><strong>模块实例化时</strong><br><br />
内部的输入端口只能是wire类型，可以连接外部的wire或者reg ，<strong>因为reg和wire都能驱动wire</strong>，无论外部是wire还是reg，其值一旦改变，wire就会跟着改变。（但是常常用reg类型，因为常常涉及到）<br><br />
内部的输出端口可以是wire或者reg类型，但<strong>外部连接的只能是wire</strong>。因为内部的信号一旦改变，<strong>外部连接的信号必须跟着改变，也就是说这两个信号是同一个信号</strong>，只有wire可以满足这个条件。<br />
如果外部连接的是reg，那么想要改变这个reg的值还必须要满足一些条件，例如时钟，always @(*)等。这是难以实现的</p>
<div style="page-break-after: always;"></div>

<h3 id="13-parameter">1.3 parameter</h3>
<h5 id="_1">使用示例</h5>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">module</span><span class="w"> </span><span class="n">fsm</span><span class="w"> </span><span class="p">(</span><span class="n">clk</span><span class="p">,</span><span class="w"> </span><span class="n">rst_n</span><span class="p">);</span><span class="w">  </span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="err">……</span><span class="w">  </span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">parameter</span><span class="w">    </span><span class="n">IDLE</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="err">’</span><span class="n">d0</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">parameter</span><span class="w">    </span><span class="n">BUSY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="err">’</span><span class="n">d1</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">parameter</span><span class="w">    </span><span class="n">WAIT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="err">’</span><span class="n">d2</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">parameter</span><span class="w">    </span><span class="n">FREE</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="err">’</span><span class="n">d3</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="err">……</span><span class="w">  </span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">endmodule</span><span class="w">  </span>
</span></code></pre></div>
<h5 id="paramter">paramter 参数定义的语法：</h5>
<p><div class="language-verilog highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">parameter</span><span class="w">  </span><span class="o">&lt;</span><span class="n">list_of_assignment</span><span class="o">&gt;</span><span class="p">;</span>
</span></code></pre></div><br />
可一次定义多个参数，用逗号隔开。</p>
<h5 id="parameter">在例化时重载parameter</h5>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">module_name</span><span class="w"> </span><span class="p">#(...)</span><span class="w"> </span><span class="n">module_a</span><span class="p">(...)</span>
</span></code></pre></div>
<p>注意：<strong>#(...)</strong> 位置关联</p>
<div style="page-break-after: always;"></div>

<h3 id="14-define">1.4 `define</h3>
<p>编译指导`define提供了一种简单的文本替换的功能:<br><br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="cp">`define &lt;macro_name&gt; &lt;macro_text&gt;&lt;br&gt;</span>
</span></code></pre></div><br />
在编译时<macro_text>替换<macro_name>。可提高描述的可读性。</p>
<h4 id="_2">示例</h4>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="cp">`define not_delay #1  </span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="cp">`define and_delay #2  </span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="cp">`define or_delay #1  </span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="k">module</span><span class="w"> </span><span class="n">MUX2_1</span><span class="w"> </span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">sel</span><span class="p">);</span><span class="w">  </span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="k">output</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="k">input</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">sel</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="k">not</span><span class="w"> </span><span class="no">`not_delay</span><span class="w"> </span><span class="n">not1</span><span class="p">(</span><span class="w"> </span><span class="n">sel_</span><span class="p">,</span><span class="w"> </span><span class="n">sel</span><span class="p">);</span><span class="w">  </span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="k">and</span><span class="w"> </span><span class="no">`and_delay</span><span class="w"> </span><span class="n">and1</span><span class="p">(</span><span class="w"> </span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">sel_</span><span class="p">);</span><span class="w">  </span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="k">and</span><span class="w"> </span><span class="no">`and_delay</span><span class="w"> </span><span class="n">and2</span><span class="p">(</span><span class="w"> </span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">sel</span><span class="p">);</span><span class="w">  </span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="k">or</span><span class="w"> </span><span class="no">`or_delay</span><span class="w"> </span><span class="n">or1</span><span class="p">(</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="n">b1</span><span class="p">);</span><span class="w">  </span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="k">endmodule</span><span class="w">  </span>
</span></code></pre></div>
<h3 id="15">1.5 值</h3>
<p><img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/%E5%80%BC.png" /><br />
z：高阻状态，含义是电路未驱动或者断开，常见于三态门、总线空闲<br />
x：未知状态，含义是信号逻辑值不确定，常见于==未初始化，驱动源冲突==，仿真异常</p>
<h3 id="16">1.6 线网类型</h3>
<p><mark>如果没有驱动，线网的缺省值是z</mark><br />
tri本意用于描述多个驱动源同时驱动一根线的线网类型，而wire本意用于描述一个驱动源的驱动。</p>
<p><strong>当驱动源冲突时</strong><br />
<img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/%E9%A9%B1%E5%8A%A8%E6%BA%90%E5%86%B2%E7%AA%81.png" /><br />
(1) 驱动源相同，则结果等于驱动源。<br />
(2) 驱动源不同，且均不为z，则结果为z。<br />
(3) 驱动源有一个是z，则结果为另一驱动源。</p>
<p><strong>其他线网类型</strong><br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">assign</span><span class="w"> </span><span class="n">a0</span><span class="o">=</span><span class="n">b</span><span class="p">;</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">assign</span><span class="w"> </span><span class="n">a0</span><span class="o">=</span><span class="n">c</span><span class="p">;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="k">assign</span><span class="w"> </span><span class="n">a0</span><span class="o">=</span><span class="n">d</span><span class="p">;</span>
</span></code></pre></div><br />
when a0 = wand? when a0 = wor?</p>
<h3 id="17">1.7 寄存器类型</h3>
<p>寄存器类型(register)分为5种子类型<br />
reg类型<br />
integer类型<br />
real类型<br />
time类型（testbench中介绍）<br />
realtime类型（testbench中介绍）</p>
<p>在硬件描述语言中，有时候数据类型并不一定与硬件电路相关，在组合逻辑的行为描述中，也会定义reg类型。</p>
<h3 id="18">1.8 位宽</h3>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="mh">256</span><span class="w"> </span><span class="c1">//非定长的十进制数</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="mh">4</span><span class="err">’</span><span class="n">b10_11</span><span class="w"> </span><span class="c1">//定长的整数常量</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="mh">8</span><span class="err">’</span><span class="n">h0a</span><span class="w"> </span><span class="c1">//定长的整数常量</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="err">‘</span><span class="n">b1</span><span class="p">,</span><span class="err">’</span><span class="n">hfba</span><span class="w"> </span><span class="c1">//非定长的整数常量</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="mf">90.006</span><span class="w"> </span><span class="c1">//实数常量</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="err">”</span><span class="n">bond</span><span class="err">”</span><span class="w"> </span><span class="c1">//字符串常量，每个字符作为8位的ascii值存储,使用时要用双引号</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data_out</span><span class="p">;</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="n">data_in</span><span class="p">;</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">9</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">ask</span><span class="p">;</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="k">assign</span><span class="w"> </span><span class="n">data_out</span><span class="o">=</span><span class="mh">4</span><span class="err">’</span><span class="n">b1000</span><span class="p">;</span><span class="w"> </span><span class="c1">//data_in[3]=1</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="k">assign</span><span class="w"> </span><span class="n">data_in</span><span class="w"> </span><span class="o">=</span><span class="mh">4</span><span class="err">’</span><span class="n">b1000</span><span class="p">;</span><span class="w"> </span><span class="c1">//data_in[0]=1</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="k">assign</span><span class="w"> </span><span class="n">ask</span><span class="o">=</span><span class="err">“</span><span class="n">x</span><span class="err">”</span><span class="p">;</span><span class="w"> </span><span class="c1">//8’b01111000 (120)</span>
</span></code></pre></div>
<p>注意：<br />
data_out=4’b1000; <mark>//data_in[3]=1</mark><br />
data_in =4’b1000; <mark>//data_in[0]=1</mark></p>
<p><strong>当位宽不一致时</strong><br />
<img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/%E4%BD%8D%E5%AE%BD%E4%B8%8D%E4%B8%80%E8%87%B4.png" /><br />
<mark>只需要记住，赋值时的常量为32b（计算机数据宽度）</mark></p>
<h3 id="19">1.9 存储器语法</h3>
<p><img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/%E5%AD%98%E5%82%A8%E5%99%A8.png" /></p>
<h3 id="110">1.10 变量的符号</h3>
<p><img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E7%AC%A6%E5%8F%B7.png" /></p>
<h3 id="111">1.11 位选择与连接运算符</h3>
<p><div class="language-verilog highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kt">reg</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="nl">m:</span><span class="n">n</span><span class="p">]</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">assign</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">data</span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">5</span><span class="p">]};</span><span class="w">  </span><span class="c1">// 合法</span>
</span></code></pre></div><br />
在 Verilog 中，<mark>合法的位选择范围a[m:n]必须满足m≥n</mark>，否则会导致语法错误或仿真异常。</p>
<h3 id="112">1.12 运算符</h3>
<h5 id="1-">① 算数运算符： * ， /， +， - ， %</h5>
<p>整数除法截断小数部分<br />
取模运算的结果符号与第一个操作数相同<br />
<mark>操作数中有x或者z，结果是x</mark></p>
<h5 id="2">② 关系操作符 &lt;, &lt;=, &gt;, &gt;=**</h5>
<p><mark>操作数中有x或者z，结果是x</mark><br />
避免出现有符号数与无符号数的比较<br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">2</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span><span class="p">;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">integer</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">q</span><span class="p">;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">b</span><span class="o">=</span><span class="mh">4</span><span class="err">’</span><span class="n">b101</span><span class="p">;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="n">e</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">&gt;</span><span class="n">c</span><span class="p">);</span><span class="w"> </span><span class="c1">//e=1</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">j</span><span class="o">=-</span><span class="w"> </span><span class="mh">4</span><span class="err">’</span><span class="n">d10</span><span class="p">;</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="n">q</span><span class="o">=</span><span class="mh">5</span><span class="p">;</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="n">d1</span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="c1">//d1=1，有符号数与无符号数的比较</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="n">d2</span><span class="o">=</span><span class="n">j</span><span class="o">&gt;</span><span class="n">q</span><span class="p">;</span><span class="w"> </span><span class="c1">//d2=0;</span>
</span></code></pre></div></p>
<h5 id="3">③ 逻辑操作符 &amp;&amp;, ||, !</h5>
<p>逻辑操作符的结果为一位1， 0或x。<br />
逻辑操作符只对逻辑值运算。<br />
<mark>若操作数只包含0、x、 z，则逻辑值为x</mark><br />
逻辑反操作符将操作数的逻辑值取反。<br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4</span><span class="err">‘</span><span class="n">b0011</span><span class="p">;</span><span class="w"> </span><span class="c1">//逻辑值为“1”</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4</span><span class="err">‘</span><span class="n">b10xz</span><span class="p">;</span><span class="w"> </span><span class="c1">//逻辑值为“1”</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4</span><span class="err">‘</span><span class="n">b0z0x</span><span class="p">;</span><span class="w"> </span><span class="c1">//逻辑值为“x”</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="c1">// e = 1</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"> </span><span class="c1">// f = x</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="c1">// g=0</span>
</span></code></pre></div></p>
<p>逻辑操作符的操作数为x/z时，结果不一定为x，例如：<br />
<mark>0 &amp;&amp; x(z) = 0</mark><br />
<mark>1 || x(z) = 1</mark><br />
!z = x<br />
!x = x</p>
<h5 id="4">④ 相等操作符</h5>
<p>**逻辑相等：<mark>， !=**<br />
==操作数中只要含有x或者z，结果是x</mark></p>
<p><strong>case等：===，!==</strong><br />
===:<br />
| A  B | 0 | 1 | x | z |<br />
| ----- | - | - | - | - |<br />
| <strong>0</strong> | 1 | 0 | 0 | 0 |<br />
| <strong>1</strong> | 0 | 1 | 0 | 0 |<br />
| <strong>x</strong> | 0 | 0 | 1 | 0 |<br />
| <strong>z</strong> | 0 | 0 | 0 | 1 |</p>
<p>!==:<br />
| A  B | 0 | 1 | x | z |<br />
| ----- | - | - | - | - |<br />
| <strong>0</strong> | 0 | 1 | 1 | 1 |<br />
| <strong>1</strong> | 1 | 0 | 1 | 1 |<br />
| <strong>x</strong> | 1 | 1 | 0 | 1 |<br />
| <strong>z</strong> | 1 | 1 | 1 | 0 |</p>
<h5 id="5">⑤ 位运算</h5>
<p><mark>对于!, ^ 和~^ ，只要操作数出现x/z，结果就是x</mark><br />
<strong>按位取反：~</strong><br />
| A | ~A |<br />
| - | --- |<br />
| 0 | 1   |<br />
| 1 | 0   |<br />
| x | x   |<br />
| z | x   |</p>
<p><strong>按位与：&amp;</strong><br />
| A  B | 0 | 1 | x | z |<br />
| ----- | - | - | - | - |<br />
| <strong>0</strong> | 0 | 0 | 0 | 0 |<br />
| <strong>1</strong> | 0 | 1 | x | x |<br />
| <strong>x</strong> | 0 | x | x | x |<br />
| <strong>z</strong> | 0 | x | x | x |</p>
<p><strong>按位或：|</strong><br />
| A  B | 0 | 1 | x | z |<br />
| ----- | - | - | - | - |<br />
| <strong>0</strong> | 0 | 1 | x | x |<br />
| <strong>1</strong> | 1 | 1 | 1 | 1 |<br />
| <strong>x</strong> | x | 1 | x | x |<br />
| <strong>z</strong> | x | 1 | x | x |</p>
<p><strong>按位异或：^</strong><br />
| A  B | 0 | 1 | x | z |<br />
| ----- | - | - | - | - |<br />
| <strong>0</strong> | 0 | 1 | x | x |<br />
| <strong>1</strong> | 1 | 0 | x | x |<br />
| <strong>x</strong> | x | x | x | x |<br />
| <strong>z</strong> | x | x | x | x |</p>
<p><strong>按位同或：~^ 或 ^~</strong><br />
| A  B | 0 | 1 | x | z |<br />
| ----- | - | - | - | - |<br />
| <strong>0</strong> | 1 | 0 | x | x |<br />
| <strong>1</strong> | 0 | 1 | x | x |<br />
| <strong>x</strong> | x | x | x | x |<br />
| <strong>z</strong> | x | x | x | x |</p>
<h5 id="6">⑥ 归约运算符</h5>
<table>
<thead>
<tr>
<th>运算符</th>
<th>名称</th>
<th>操作含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&amp;</code></td>
<td>归约与</td>
<td>所有位与运算（全部为 1 → 1，否则为 0）</td>
</tr>
<tr>
<td><code>\|</code></td>
<td>归约或</td>
<td>所有位或运算（任一位为 1 → 1，全为 0 → 0 ）</td>
</tr>
<tr>
<td><code>^</code></td>
<td>归约异或</td>
<td>所有位异或（1 的个数为奇数 → 1）</td>
</tr>
<tr>
<td><code>~&amp;</code></td>
<td>归约与非</td>
<td><code>~&amp;a = ~(&amp;a)</code></td>
</tr>
<tr>
<td><code>~\|</code></td>
<td>归约或非</td>
<td><code>~\|a = ~(\|a)</code></td>
</tr>
<tr>
<td><code>~^</code>或<code>^~</code></td>
<td>归约同或</td>
<td>等价于 <code>~(^a)</code></td>
</tr>
</tbody>
</table>
<p>或者从最低位到最高位运算<br />
或者参见：<br />
<img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/%E5%BD%92%E7%BA%A6%E8%BF%90%E7%AE%97%E7%A4%BA%E6%84%8F%E5%9B%BE.png" /></p>
<h5 id="7">⑦ 移位运算符</h5>
<p>在移位操作中，右边的操作数总是被当成无符号数，因此在需要位扩展时总是填0。<br />
<mark>移入的位只能是0。</mark><br />
一般用连接运算符取代<br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="k">assign</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="mh">3</span><span class="p">;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="k">assign</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="p">{</span><span class="n">data</span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="mh">3</span><span class="err">’</span><span class="n">b0</span><span class="p">};</span>
</span></code></pre></div></p>
<h5 id="8">⑧ 条件运算符</h5>
<p><img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/%E6%9D%A1%E4%BB%B6%E8%BF%90%E7%AE%97%E7%AC%A6.png" /></p>
<h5 id="9">⑨ 操作符优先级</h5>
<p><img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/%E6%93%8D%E4%BD%9C%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7.png" /></p>
<div style="page-break-after: always;"></div>

<h2 id="verilog_1">二、Verilog：组合逻辑与行为建模</h2>
<h3 id="21">2.1 数据流模型</h3>
<p>数据流模型：主要用于组合逻辑的描述，采用assign语句进行赋值，通过布尔表达式能清楚地反映电路的功能结构与组合逻辑的数据特性。</p>
<h3 id="22">2.2 行为级模型</h3>
<h5 id="221">2.2.1 过程结构</h5>
<p>initial结构（块）——单次执行<br />
always结构（块）——重复执行</p>
<p>begin…end结构中语句顺序执行，只有一条语句时begin…end可以省略。<br />
fork…join结构中语句的并行执行。</p>
<h5 id="222">2.2.2 过程块中的赋值</h5>
<p>在过程块中的赋值称为<strong>过程赋值</strong>，在过程赋值语句中表达式左边的信号<strong>必须是寄存器类型</strong>，表达式右边类型没有限制。</p>
<p><strong>案例：时钟产生</strong><br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">always</span><span class="w"> </span><span class="p">#</span><span class="mh">5</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk</span><span class="p">;</span>
</span></code></pre></div></p>
<h5 id="223">2.2.3 过程块中的分支结构</h5>
<p>if...else分支结构只能在过程块中使用<br />
<mark>考虑所有的分支情况；</mark><br />
<mark>尽量少地使用嵌套；</mark></p>
<p><strong>案例：case语句</strong><br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="err">……</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="n">a</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="k">begin</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="k">case</span><span class="p">({</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">})</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="mh">2</span><span class="err">’</span><span class="nl">b10:</span><span class="n">c</span><span class="o">=</span><span class="mh">1</span><span class="err">’</span><span class="n">b1</span><span class="p">;</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="mh">2</span><span class="err">’</span><span class="nl">b01:</span><span class="n">c</span><span class="o">=</span><span class="mh">1</span><span class="err">’</span><span class="n">b0</span><span class="p">;</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="k">default</span><span class="o">:</span><span class="n">c</span><span class="o">=</span><span class="mh">1</span><span class="err">’</span><span class="n">b1</span><span class="p">;</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="k">endcase</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="k">end</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="err">……</span>
</span></code></pre></div><br />
<mark>注意：default</mark></p>
<p><strong>case语句进行逐位比较以求完全匹配（包括x和z）</strong><br />
<img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/case.png" /><br />
<strong>在casez语句中，<mark>? 和z</mark> 被当作无关值。</strong><br />
<img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/casez.png" /><br />
<strong>在casex语句中，<mark>?，z 和x</mark> 被当作无关值。</strong><br />
<img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/casex.png" /></p>
<h5 id="224">2.2.4 过程块中的循环结构</h5>
<p>repeat：将一块语句循环执行确定次数。<br />
repeat (次数表达式)&lt;语句&gt;</p>
<p>while：在条件表达式为真时一直循环执行<br />
while (条件表达式)&lt;语句&gt;</p>
<p>forever：重复执行直到仿真结束<br />
forever &lt;语句&gt;<br />
<mark>forever应该是过程块中最后一条语句。其后的语句将永远不会执行。forever语句不可综合，通常用于test bench描述。</mark><br />
案例：<br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">initial</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="k">begin</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="k">forever</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="k">begin</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="k">end</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="k">end</span>
</span></code></pre></div></p>
<p>for：在执行过程中对变量进行计算和判断，在条件满足时执行<br />
for(赋初值；条件表达式；计算)&lt;语句&gt;</p>
<div style="page-break-after: always;"></div>

<h2 id="_3">三、时序逻辑电路设计基础</h2>
<p><mark>不要在一个always块中同时使用阻塞和非阻塞</mark>。<br />
建模==时序逻辑时使用非阻塞赋值==。<br />
使用always块描述组合逻辑，使用阻塞赋值。<br />
<mark>不能在不同的always块中多次赋值一个信号</mark>。</p>
<div style="page-break-after: always;"></div>

<h2 id="testbench">四、模块例化与testbench设计</h2>
<h3 id="41">4.1 模块例化注意事项</h3>
<p>尽量使用名字关联<br />
注意端口位宽的一致性<br />
检查端口连接规则<br />
<mark>不要出现没有连接的端口，没有连接的输入端口初始化值为x。</mark><br />
一般不需要显式声明模块端口</p>
<h3 id="42-testbench">4.2 Testbench设计</h3>
<p>示例代码<br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="o">/</span><span class="mh">10</span><span class="n">ps</span><span class="w">          </span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c1">//编译指导，规定时间单位与精度</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="no">`include</span><span class="w"> </span><span class="err">“</span><span class="n">full_addder</span><span class="p">.</span><span class="n">v</span><span class="err">”</span><span class="w">   </span><span class="c1">//编译指导，包含所需文件</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="k">module</span><span class="w"> </span><span class="n">testbench</span><span class="w"> </span><span class="p">();</span><span class="w">        </span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1">//testbench</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="kt">wire</span><span class="w"> </span><span class="n">sum_out</span><span class="p">;</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="kt">reg</span><span class="w"> </span><span class="n">a_input</span><span class="p">,</span><span class="w"> </span><span class="n">b_input</span><span class="p">,</span><span class="w"> </span><span class="n">cin</span><span class="p">;</span><span class="w">               </span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="n">full_adder</span><span class="w"> </span><span class="n">fa1</span><span class="p">(.</span><span class="n">a</span><span class="p">(</span><span class="n">a_input</span><span class="p">)</span><span class="w">           </span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">              </span><span class="p">,.</span><span class="n">b</span><span class="p">(</span><span class="n">b_input</span><span class="p">)</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">              </span><span class="p">,.</span><span class="n">cin</span><span class="p">(</span><span class="n">cin</span><span class="p">)</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">              </span><span class="p">,.</span><span class="n">sum</span><span class="p">(</span><span class="n">sum_out</span><span class="p">)</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w">              </span><span class="p">,.</span><span class="n">cout</span><span class="p">(</span><span class="n">cout</span><span class="p">));</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="k">initial</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="k">fork</span><span class="w">                                             </span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="n">a_input</span><span class="o">=</span><span class="mh">0</span><span class="p">;</span><span class="n">b_input</span><span class="o">=</span><span class="mh">0</span><span class="p">;</span><span class="n">cin</span><span class="o">=</span><span class="mh">0</span><span class="p">;</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="p">#</span><span class="mh">10</span><span class="w">  </span><span class="n">a_input</span><span class="o">=</span><span class="mh">0</span><span class="p">;</span><span class="n">b_input</span><span class="o">=</span><span class="mh">0</span><span class="p">;</span><span class="n">cin</span><span class="o">=</span><span class="mh">1</span><span class="p">;</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="p">#</span><span class="mh">15</span><span class="w">  </span><span class="n">a_input</span><span class="o">=</span><span class="mh">1</span><span class="p">;</span><span class="n">b_input</span><span class="o">=</span><span class="mh">1</span><span class="p">;</span><span class="n">cin</span><span class="o">=</span><span class="mh">0</span><span class="p">;</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="p">#</span><span class="mh">25</span><span class="w">  </span><span class="nb">$finish</span><span class="p">;</span><span class="w">                                           </span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="k">join</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="k">endmodule</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="w"> </span><span class="err">```</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="p">#####</span><span class="w"> </span><span class="mf">4.2.1</span><span class="w"> </span><span class="no">`timescale</span><span class="w"> </span><span class="o">&lt;</span><span class="n">time_unit</span><span class="o">&gt;</span><span class="w"> </span><span class="o">/&lt;</span><span class="n">time_precision</span><span class="o">&gt;</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="nl">time_unit:</span><span class="w"> </span><span class="err">时间单位</span>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="nl">time_precision:</span><span class="w"> </span><span class="err">时间精度</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="no">`timescale必须在模块之前出现</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="p">#####</span><span class="w"> </span><span class="mf">4.2.2</span><span class="w"> </span><span class="err">有关</span><span class="k">fork</span><span class="p">...</span><span class="k">join</span>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="k">fork</span><span class="err">…</span><span class="n">join块在测试文件中很常用</span><span class="err">。他们的并行特性使用户以说明绝对时间，并且可以并行的执行复杂的过程结构，如循环或任务</span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="err">``</span><span class="no">`verilog</span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="k">module</span><span class="w"> </span><span class="n">inline_</span><span class="w"> </span><span class="n">tb</span><span class="p">;</span>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="w"> </span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data_</span><span class="w"> </span><span class="n">bus</span><span class="p">;</span>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a><span class="c1">// instance of DUT</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a><span class="k">initial</span><span class="w">    </span><span class="k">fork</span>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a><span class="n">data_bus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8</span><span class="mb">&#39;b00</span><span class="p">;</span>
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">data_bus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;h45</span><span class="p">;</span>
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a><span class="p">#</span><span class="mh">20</span><span class="w"> </span><span class="k">repeat</span><span class="w"> </span><span class="p">(</span><span class="mh">10</span><span class="p">)</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">data_bus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_bus</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a><span class="p">#</span><span class="mh">25</span><span class="w"> </span><span class="k">repeat</span><span class="w"> </span><span class="p">(</span><span class="mh">5</span><span class="p">)</span><span class="w"> </span><span class="p">#</span><span class="mh">20</span><span class="w"> </span><span class="n">data_bus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_bus</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a><span class="p">#</span><span class="mh">140</span><span class="w"> </span><span class="n">data_bus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;h0f</span><span class="p">;</span>
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a><span class="k">join</span>
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a><span class="k">endmodule</span>
</span></code></pre></div></p>
<h5 id="423">4.2.3 循环激励</h5>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">module</span><span class="w"> </span><span class="n">loop_tb</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="kt">reg</span><span class="w"> </span><span class="n">clk</span><span class="p">;</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">stimulus</span><span class="p">;</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">results</span><span class="p">;</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="k">integer</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="n">DUT</span><span class="w"> </span><span class="n">u1</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">stimulus</span><span class="p">);</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="k">always</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="p">#</span><span class="mh">5</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w">  </span><span class="p">#</span><span class="mh">5</span><span class="w">  </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="k">end</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">256</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">    </span><span class="k">begin</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">        </span><span class="p">@(</span><span class="k">negedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="n">stimulus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="k">end</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="p">#</span><span class="mh">20</span><span class="w"> </span><span class="n">finish</span><span class="p">;</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="k">endmodule</span>
</span></code></pre></div>
<h5 id="424">4.2.4 存储器激励</h5>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="k">module</span><span class="w"> </span><span class="n">array_</span><span class="w"> </span><span class="n">tb</span><span class="p">;</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="w"> </span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data_</span><span class="w"> </span><span class="n">bus</span><span class="p">,</span><span class="w"> </span><span class="n">stim_</span><span class="w"> </span><span class="n">array</span><span class="p">[</span><span class="w"> </span><span class="mh">0</span><span class="o">:</span><span class="w"> </span><span class="mh">15</span><span class="p">];</span><span class="w"> </span><span class="c1">// 数组</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="k">integer</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">DUT</span><span class="w"> </span><span class="n">u1</span><span class="w"> </span><span class="p">(</span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">stimulus</span><span class="p">);</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="c1">// 从数组读入数据</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="p">#</span><span class="mh">20</span><span class="w"> </span><span class="n">stimulus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stim_array</span><span class="p">[</span><span class="mh">0</span><span class="p">];</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="p">#</span><span class="mh">30</span><span class="w"> </span><span class="n">stimulus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stim_array</span><span class="p">[</span><span class="mh">15</span><span class="p">];</span><span class="w"> </span><span class="c1">// 线激励</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="p">#</span><span class="mh">20</span><span class="w"> </span><span class="n">stimulus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stim_array</span><span class="p">[</span><span class="mh">1</span><span class="p">];</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">14</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span><span class="w"> </span><span class="c1">// 循环</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="p">#</span><span class="mh">50</span><span class="w"> </span><span class="n">stimulus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stim_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="p">#</span><span class="mh">30</span><span class="w"> </span><span class="nb">$finish</span><span class="p">;</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="k">end</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="k">endmodule</span>
</span></code></pre></div>
<h5 id="525-testbench">5.2.5 Testbench中的常见系统函数</h5>
<p><img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/display.png" /><br />
<img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/monitor.png" /><br />
<img alt="" src="../Study_notes_material/Verilog%E5%9F%BA%E7%A1%80/monitor%E4%B8%BE%E4%BE%8B.png" /></p>
<h2 id="_4">五、状态机设计</h2>
<p>有限状态机（Finite-state machine）是一种计算机科学与数学理论的抽象，将一些问题<br />
抽象成一组有限状态之间的切换及其控制，是数字逻辑与程序设计的基础之一。有限状<br />
态机在数字逻辑、控制、通讯、编译器设计、甚至生物领域都有着广泛的应用。</p>
<h3 id="51">5.1 状态机的分类</h3>
<p>摩尔型（Moore）<br />
摩尔型状态机的输出只与当前状态有关，与输入无关。<br />
米利型（Mealy）<br />
米利型状态机的输出不仅与当前状态有关，还与当前输入有关  </p>
<h3 id="52">5.2 设计步骤</h3>
<ol>
<li>确定状态机的基本行为  </li>
<li>建立状态、输出表  </li>
<li>优化状态机状态数目（optional）  </li>
<li>给状态机编码  </li>
<li>以状态、输出表为基础建立转换、输出表（图）  </li>
<li>求输出表达式  </li>
<li>完成完整的状态机设计  </li>
</ol>
<h3 id="53">5.3 两段式经典状态机设计（无输出）</h3>
<p>示例：<br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">module</span><span class="w"> </span><span class="n">fsm</span><span class="p">(</span><span class="n">dly</span><span class="p">,</span><span class="w"> </span><span class="n">done</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="n">clk</span><span class="p">,</span><span class="w"> </span><span class="n">rst_n</span><span class="p">);</span><span class="w">  </span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="k">input</span><span class="w"> </span><span class="n">dly</span><span class="p">,</span><span class="w"> </span><span class="n">done</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="n">clk</span><span class="p">,</span><span class="w"> </span><span class="n">rst_n</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="k">parameter</span><span class="w">   </span><span class="n">IDLE</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="mi">&#39;d0</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="k">parameter</span><span class="w">   </span><span class="n">BUSY</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="mi">&#39;d1</span><span class="p">;</span><span class="w">   </span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="k">parameter</span><span class="w">   </span><span class="n">WAIT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="mi">&#39;d2</span><span class="p">;</span><span class="w">    </span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="k">parameter</span><span class="w">   </span><span class="n">FREE</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="mi">&#39;d3</span><span class="p">;</span><span class="w">         </span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">current_state</span><span class="p">,</span><span class="n">next</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="c1">// 时序逻辑段</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">negedge</span><span class="w"> </span><span class="n">rst_n</span><span class="p">)</span><span class="w">  </span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">rst_n</span><span class="p">)</span><span class="w">  </span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="w">        </span><span class="n">current_state</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">IDLE</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="w">    </span><span class="k">else</span><span class="w">     </span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="w">        </span><span class="n">current_state</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">next</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="c1">// 组合逻辑段</span>
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="n">current_state</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">dly</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">done</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">req</span><span class="p">)</span><span class="w">   </span>
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a><span class="k">begin</span><span class="w">  </span>
</span><span id="__span-17-19"><a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="p">&#39;</span><span class="n">bx</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-20"><a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">current_state</span><span class="p">)</span><span class="w">  </span>
</span><span id="__span-17-21"><a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a><span class="w">    </span><span class="n">IDLE</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>
</span><span id="__span-17-22"><a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">req</span><span class="p">)</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BUSY</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-23"><a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IDLE</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-24"><a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a><span class="w">    </span><span class="nl">BUSY:</span><span class="w"> </span><span class="k">begin</span><span class="w">  </span>
</span><span id="__span-17-25"><a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">done</span><span class="p">)</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BUSY</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-26"><a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">dly</span><span class="p">)</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WAIT</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-27"><a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FREE</span><span class="p">;</span><span class="w">  </span><span class="k">end</span><span class="w">  </span>
</span><span id="__span-17-28"><a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a><span class="w">    </span><span class="nl">WAIT:</span><span class="w"> </span><span class="k">begin</span><span class="w">  </span>
</span><span id="__span-17-29"><a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">dly</span><span class="p">)</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FREE</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-30"><a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WAIT</span><span class="p">;</span><span class="w">  </span><span class="k">end</span><span class="w">  </span>
</span><span id="__span-17-31"><a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a><span class="w">    </span><span class="nl">FREE:</span><span class="w">   </span>
</span><span id="__span-17-32"><a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">req</span><span class="p">)</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BUSY</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-33"><a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IDLE</span><span class="p">;</span><span class="w">  </span>
</span><span id="__span-17-34"><a id="__codelineno-17-34" name="__codelineno-17-34" href="#__codelineno-17-34"></a><span class="k">endcase</span><span class="w">  </span>
</span><span id="__span-17-35"><a id="__codelineno-17-35" name="__codelineno-17-35" href="#__codelineno-17-35"></a><span class="k">end</span><span class="w">  </span>
</span><span id="__span-17-36"><a id="__codelineno-17-36" name="__codelineno-17-36" href="#__codelineno-17-36"></a><span class="k">endmodule</span><span class="w">  </span>
</span></code></pre></div><br />
1. 用两个always块来描述状态机，一个always块用来描述<strong>新状态的产生（组合逻辑）</strong>，一个always块用来描述<strong>状态迁移（时序逻辑）</strong>。<br />
2. 使用<strong>parameter定义状态</strong>。<br />
3. 时序逻辑使用非阻塞赋值，组合逻辑使用阻塞赋值。<br />
4. always块中，敏感列表需要包括当前状态和所有输入<br />
5. <mark>在组合逻辑块的开始，指定next state的缺省值。</mark>  </p>
<p><br><br />
<br><br />
<br><br />
<br></p>
<div style="page-break-after: always;"></div>

<h3 id="54-next_state">5.4 next_state的初始值：</h3>
<p>一般来说next state有三种初始值:<strong>2’bx、ilde、其他state</strong>。<br />
- <strong>2'bx</strong>:用于debug，一个完善的状态机必须能够消除x的影响，正确进入状态循环。<br />
- <strong>ilde</strong>：零状态  </p>
<p>当逻辑中没有出现next state分配的时候，<strong>初始值有利于debug</strong>。</p>
<p>在数字芯片中，一般有一个reset过程，使电路有一个初始值。<br />
初始值的赋值由<strong>rst</strong>在<strong>testbench</strong>完成，而<strong>非设计模块</strong>中。组合逻辑输入主要来自寄存器，还有一些输入是恒0、恒1输入。一般来说，<strong>组合逻辑的初始化是没有必要的</strong>。  </p>
<p><br><br />
<br></p>
<h3 id="55">5.5 状态的编码方式</h3>
<h5 id="1">方法1. 普通二进制编码</h5>
<p>3’b000,3’b001,3’b010,3’b011…<br><br />
编码紧凑，节省寄存器资源。状态之间翻转多，影响速度。</p>
<h5 id="2_1">方法2. 独热码</h5>
<p>3’b001,3’b010,3’b100…<br><br />
速度快，设计简单，易于维护，消耗寄存器资源多。</p>
<h5 id="3_1">方法3. 格雷码</h5>
<p>3’b000,3’b001,3’b011,3’b010…<br><br />
状态之间翻转少，状态的编码分配较困难。(因为顺序是固定的)</p>
<p><br><br />
<br><br />
<br><br />
<br></p>
<div style="page-break-after: always;"></div>

<h3 id="56">5.6 考虑输出的状态设计</h3>
<h5 id="_5">常见输出方式</h5>
<p><img alt="" src="../Study_notes_material/%E7%8A%B6%E6%80%81%E6%9C%BA%E8%AE%BE%E8%AE%A1/%E8%80%83%E8%99%91%E8%BE%93%E5%87%BA%E7%9A%84%E7%8A%B6%E6%80%81%E8%AE%BE%E8%AE%A1.png" /></p>
<p><br><br />
<br><br />
<br><br />
<br></p>
<div style="page-break-after: always;"></div>

<h3 id="57">5.7 三段式经典状态机设计（有输出）</h3>
<p>大致模板与二段式相同，只不过由于有输出信号，所以除了==计算新状态的组合逻辑块==和==转移状态的时序逻辑块==之外，还有一个<strong>输出的块</strong><br><br />
输出块：<br><br />
<strong>组合逻辑输出(问题：毛刺)：</strong> <br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">assign</span><span class="w"> </span><span class="n">rd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="o">==</span><span class="n">READ</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">state</span><span class="o">==</span><span class="n">DLY</span><span class="p">);</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="k">assign</span><span class="w"> </span><span class="n">ds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="o">==</span><span class="n">DONE</span><span class="p">);</span>
</span></code></pre></div><br />
<strong>寄存器输出(问题：会延迟一个周期)</strong> <br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">negedge</span><span class="w"> </span><span class="n">rst_n</span><span class="p">)</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">rst_n</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">    </span><span class="n">ds</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">    </span><span class="n">rd</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="k">end</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">    </span><span class="n">ds</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">    </span><span class="n">rd</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">        </span><span class="nl">IDLE:</span><span class="w">     </span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">go</span><span class="p">)</span><span class="w"> </span><span class="n">rd</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">        </span><span class="nl">READ:</span><span class="w">    </span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="w">            </span><span class="n">rd</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="w">        </span><span class="nl">DLY:</span><span class="w">     </span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ws</span><span class="p">)</span><span class="w"> </span><span class="n">rd</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="n">ds</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">;</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="k">endcase</span>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="k">end</span>
</span></code></pre></div><br />
<strong>状态编码输出：</strong><br><br />
还有一种极为特殊的输出方式，而且是性能最好的实现方式，<strong>即将输出信号包含在状态编码中，这样就能直接输出，没有任何外加延时</strong>，然而缺点就是，这给==状态的编码造成了很大困难==<br />
<img alt="" src="../Study_notes_material/%E7%8A%B6%E6%80%81%E6%9C%BA%E8%AE%BE%E8%AE%A1/%E7%8A%B6%E6%80%81%E7%BC%96%E7%A0%81%E8%BE%93%E5%87%BA.png" /><br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">assign</span><span class="w"> </span><span class="p">{</span><span class="n">ds</span><span class="p">,</span><span class="n">rd</span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>
</span></code></pre></div></p>
<div style="page-break-after: always;"></div>

<h2 id="_6">六、文件读写</h2>
<h3 id="_7">指定地址的文件读操作</h3>
<p><strong>$readmemb</strong><br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="nb">$readmemb</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;file_name&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">memory_name</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">start_addr</span><span class="o">&gt;</span><span class="p">);</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="nb">$readmemb</span><span class="p">(</span><span class="s">&quot;file_name&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">memory_name</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">start_addr</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">finish_addr</span><span class="o">&gt;</span><span class="p">);</span>
</span></code></pre></div><br />
<strong>$readmemh</strong><br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nb">$readmemh</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;file_name&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">memory_name</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">start_addr</span><span class="o">&gt;</span><span class="p">);</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="nb">$readmemh</span><span class="p">(</span><span class="s">&quot;file_name&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">memory_name</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">start_addr</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">finish_addr</span><span class="o">&gt;</span><span class="p">);</span>
</span></code></pre></div></p>
<p>start和finish决定存储器将被装载的地址。start为开始地址，finish为结束地址。如果不指定开始和结束地址，$readmem开始读入数据，<strong>从存储器的最低地址开始存放</strong>。<br><br />
示例：<br />
<img alt="" src="../Study_notes_material/%E6%96%87%E4%BB%B6IO/%E6%96%87%E4%BB%B6%E8%AF%BB%E6%93%8D%E4%BD%9C%E7%A4%BA%E4%BE%8B.png" /></p>
<h5 id="_8">文件格式说明</h5>
<ol>
<li>可指定二进制(b)或十六进制(h)数</li>
<li>用下划线提高可读性。</li>
<li>可以包含单行或多行注释。</li>
<li>可以用空格和换行区分存储器字。</li>
<li>可以给后面的值设定一个<strong>特定的地址</strong>，格式为：<strong>@(hex_address)</strong>，意思是==将该数据放入对应地址的存储单元中==</li>
<li>十六进制地址的大小写不敏感。</li>
<li>在@和数字之间不允许有空格 。</li>
</ol>
<p><img alt="" src="../Study_notes_material/%E6%96%87%E4%BB%B6IO/%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A4%BA%E4%BE%8B.png" /></p>
<h3 id="_9">文件输出</h3>
<p>$monitor,$display等系统任务可以将结果输出到标准输出设备，相似的系统任务<strong>($fmonitor, $fdisplay)可以将结果输出到文件中</strong>。</p>
<p>$fopen<br />
打开一个文件并返回一个多通道描述符（MCD）。<br />
• MCD是与文件唯一对应的32位无符号整数。<br />
• 如果文件<strong>不能打开并进行写操作，MCD将等于0</strong>。<br />
• 如果文件成功打开，MCD中的一位将被置位。</p>
<p><strong>以$f开始的显示系统任务将输出写入与MCD相对应的文件中。</strong><br />
<br><br />
<br><br />
<strong>文件输出举例</strong><br />
<img alt="" src="../Study_notes_material/%E6%96%87%E4%BB%B6IO/%E6%96%87%E4%BB%B6%E8%BE%93%E5%87%BA%E4%B8%BE%E4%BE%8B.png" /><br />
<strong>读写任务函数</strong><br />
<img alt="" src="../Study_notes_material/%E6%96%87%E4%BB%B6IO/%E8%AF%BB%E5%86%99%E4%BB%BB%E5%8A%A1%E5%87%BD%E6%95%B0.png" /></p>
<div style="page-break-after: always;"></div>

<h2 id="_10">七、任务</h2>
<p>任务: 一般用于编写测试模块，或者行为描述的模块。</p>
<h3 id="task">Task的定义</h3>
<p>示例：<br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">task</span><span class="w"> </span><span class="n">task_identifier</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="p">{</span><span class="w"> </span><span class="n">task_item_declaration</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="k">input</span><span class="w"> </span><span class="err">…</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="k">output</span><span class="w"> </span><span class="err">…</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="k">inout</span><span class="w"> </span><span class="err">…</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="err">数据类型定义</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="p">}</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="err">功能描述</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="n">statement_or_null</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="k">endtask</span>
</span></code></pre></div><br />
端口与数据类型的声明语法与module相同，但<strong>不能声明线网类型</strong>，port声明并非必要，task可以不包含任何port声明。</p>
<h3 id="task_1">Task的调用</h3>
<p>只能在<strong>initial块</strong>和<strong>always块</strong>中调用任务<br><br />
调用格式:<br><br />
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">task_identifier</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
</span></code></pre></div></p>
<h3 id="_11">注意事项</h3>
<ol>
<li>任务一般在调用它的<strong>模块内部</strong>定义，也可以<strong>在当前文件中定义</strong>，也可以在<strong>单独的文件中定义</strong>，这时需要在调用它的模块文件中通过编译指导`include包括进来。</li>
<li>任务可以用来建模时序逻辑，也可以用来建模组合逻辑。</li>
<li>模块的端口可以使任意数目（也可以<strong>无端口</strong>）</li>
<li>其中可以包含<strong>时间控制(# delays, @, wait)</strong></li>
<li>任务<strong>可以接受和驱动全局变量</strong>（module范围内），当任务中使用局部变量时，局部变量在任务的最后需要传递给输出端口才能输出。</li>
<li>任务中定义的变量属于任务的局部变量。任务中<strong>定义的端口顺序</strong>决定了任务在被调用时<strong>全局变量的位置顺序</strong></li>
<li>任务可以调用任务或者函数。</li>
</ol>
<h3 id="_12">示例</h3>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="k">module</span><span class="w"> </span><span class="n">test</span><span class="p">;</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">  </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">  </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8</span><span class="mi">&#39;d10</span><span class="p">;</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8</span><span class="mi">&#39;d20</span><span class="p">;</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">    </span><span class="n">add_two</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">    </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;Result = %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">  </span><span class="c1">// 输出：Result = 30</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="w">  </span><span class="k">end</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="w">  </span><span class="c1">// 任务定义放在同一个 module 内部</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="w">  </span><span class="k">task</span><span class="w"> </span><span class="n">add_two</span><span class="p">;</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="w">    </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">sum</span><span class="p">;</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="w">    </span><span class="k">begin</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="w">      </span><span class="n">sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="w">  </span><span class="k">endtask</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="k">endmodule</span>
</span></code></pre></div>
<p><img alt="" src="../Study_notes_material/%E4%BB%BB%E5%8A%A1%E4%B8%8E%E5%87%BD%E6%95%B0/%E4%BB%BB%E5%8A%A1%E4%B8%BE%E4%BE%8B2.png" /><br />
<br><br />
<br><br />
<br><br />
<br></p>
<div style="page-break-after: always;"></div>

<h2 id="_13">八、函数</h2>
<h3 id="function">function的定义</h3>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">function</span><span class="p">[</span><span class="err">宽度与类型</span><span class="p">]</span><span class="w"> </span><span class="n">function_identifier</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="n">function_item_declaratio</span><span class="p">{</span><span class="n">function_item_declaration</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="n">statement</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="k">endfunction</span>
</span></code></pre></div>
<h3 id="_14">注意事项</h3>
<ol>
<li>一般在调用它的模块内部定义。也可以在单独的文件中定义，这时需要在调用它的模块文件中通过编译指导`include包括进来。</li>
<li>宽度与类型可以不定义，这时<strong>函数使用缺省的值：1bit reg类型</strong>（<mark>因为function在过程块中被调用</mark>），函数必须有至少一个的输入，但不能含有任何输出。</li>
<li>函数定义<strong>不能包含任何定时控制语句</strong>（<mark>纯组合电路的计算</mark>）（<mark>函数仿真时间为0</mark>）</li>
<li>函数中定义的变量属于函数的局部变量。函数中定义的<strong>端口顺序</strong>决定了函数在被调用时全局变量的位置顺序。</li>
<li><strong>一个函数只能返回一个值</strong>，该值的变量名与函数同名，数据类型默认为reg类型。</li>
<li>函数可以接受和驱动全局变量（module范围内），当函数中使用局部变量时，局部变量的输出需要传递给返回值。</li>
<li><strong>函数不能调用任务</strong>，但任务可以调用函数。</li>
<li><strong>函数中不能声明线网类型</strong></li>
</ol>
<h3 id="_15">函数的调用</h3>
<ol>
<li><mark>函数在调用时传递给函数的变量顺序与函数输入端口的声明顺序相同</mark>。</li>
<li>函数可以在持续赋值语句或者过程中调用。</li>
</ol>
<h3 id="_16">函数应用举例</h3>
<div class="language-verilog highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">module</span><span class="w"> </span><span class="n">foo</span><span class="p">(</span><span class="n">loo</span><span class="p">);</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">  </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">loo</span><span class="p">;</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">  </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">goo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero_count</span><span class="p">(</span><span class="n">loo</span><span class="p">);</span><span class="w">  </span><span class="c1">// 在持续赋值中调用函数</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">  </span><span class="k">function</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">zero_count</span><span class="p">;</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">    </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">in_bus</span><span class="p">;</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">    </span><span class="k">integer</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">    </span><span class="k">begin</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">      </span><span class="n">zero_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">8</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">in_bus</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="w">          </span><span class="n">zero_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero_count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="w">      </span><span class="k">end</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="w">    </span><span class="k">end</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="w">  </span><span class="k">endfunction</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="k">endmodule</span>
</span></code></pre></div>
<h3 id="_17">函数与任务的特点</h3>
<ol>
<li>
<p><mark>函数与任务的全部行为都可以用module代替</mark><br />
<strong>抽象层次</strong>：<br />
module&gt;过程块&gt;task&gt;function&gt;if, repeat, for...</p>
</li>
<li>
<p><mark>在任务和函数中不能声明线网类型</mark></p>
</li>
<li>
<p>任务和函数必须在module内调用</p>
</li>
<li>
<p>所有输出/输出都是局部寄存器</p>
</li>
<li>
<p>任务/函数执行完成后才返回结果。例如，若任务/函数中有forever语句，则永远不会返回结果</p>
</li>
<li>
<p>系统任务与系统函数<br />
读取当前仿真时间的<strong>系统函数</strong><br />
$time：返回32位整数时间，对大于<span class="arithmatex">\(2^{32}\)</span>的时间，返回模<span class="arithmatex">\(2^{32}\)</span>的值。使用它可以节省显示及打印空间。<br />
$stime：返回64位整数时间<br />
$realtime：返回实数时间<br />
Verilog<br />
支持文本输出的<strong>系统任务</strong><br />
$display<br />
$strobe<br />
$write<br />
$monitor</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>项目</th>
<th>function（函数）</th>
<th>task（任务）</th>
</tr>
</thead>
<tbody>
<tr>
<td>定义方式</td>
<td><code>function ... endfunction</code></td>
<td><code>task ... endtask</code></td>
</tr>
<tr>
<td>是否有返回值</td>
<td>✅ 有返回值（通过函数名返回）</td>
<td>❌ 无返回值（通过 <code>output</code> 参数输出）</td>
</tr>
<tr>
<td>参数类型</td>
<td>只能是 <code>input</code></td>
<td>可以有 <code>input</code>、<code>output</code>、<code>inout</code></td>
</tr>
<tr>
<td>是否支持延时控制</td>
<td>❌ 不支持 <code>#</code>、<code>@</code> 等延时语句</td>
<td>✅ 支持延时语句（<code>#10</code>、<code>@(posedge clk)</code> 等）</td>
</tr>
<tr>
<td>是否允许调用其他任务</td>
<td>❌ 不可以调用其他任务</td>
<td>✅ 可以调用任务或函数</td>
</tr>
<tr>
<td>通常使用场景</td>
<td>组合逻辑建模、表达式中使用</td>
<td>时序逻辑建模、复杂行为建模、testbench等</td>
</tr>
<tr>
<td>可否在持续赋值中调用</td>
<td>✅ 可以，例如 <code>assign out = f(a);</code></td>
<td>❌ 不可以</td>
</tr>
<tr>
<td>是否支持多返回值</td>
<td>❌ 不支持</td>
<td>✅ 可通过多个 <code>output</code> 参数返回多个值</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>

<h2 id="verilog_2">九、Verilog可综合语法</h2>
<table>
<thead>
<tr>
<th>语法或语句</th>
<th>是否可综合</th>
<th>用途或限制说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>assign</td>
<td>✅ 可综合</td>
<td>用于建模组合逻辑</td>
</tr>
<tr>
<td>always @(*)</td>
<td>✅ 可综合</td>
<td>用于建模组合逻辑</td>
</tr>
<tr>
<td>always @(posedge clk)</td>
<td>✅ 可综合</td>
<td>用于建模时序逻辑</td>
</tr>
<tr>
<td>if / else</td>
<td>✅ 可综合</td>
<td>可用于组合或时序逻辑</td>
</tr>
<tr>
<td>case / casez</td>
<td>✅ 可综合</td>
<td>常用于多路选择器、状态机建模</td>
</tr>
<tr>
<td>for / while</td>
<td>✅ 可综合（有条件）</td>
<td>条件必须静态可确定；循环次数固定</td>
</tr>
<tr>
<td>function</td>
<td>✅ 可综合（受限）</td>
<td>仅用于组合逻辑，不能包含延迟语句</td>
</tr>
<tr>
<td>reg / wire</td>
<td>✅ 可综合</td>
<td>用于信号声明</td>
</tr>
<tr>
<td>module / endmodule</td>
<td>✅ 可综合</td>
<td>模块化设计基础</td>
</tr>
<tr>
<td>initial</td>
<td>❌ 不可综合</td>
<td>仅仿真用，用于 testbench 初值设定</td>
</tr>
<tr>
<td>#延时（如 #5）</td>
<td>❌ 不可综合</td>
<td>仅用于仿真行为，表示时间延迟</td>
</tr>
<tr>
<td>$display, $finish</td>
<td>❌ 不可综合</td>
<td>仿真系统函数，只能用于 testbench</td>
</tr>
<tr>
<td>@(posedge clk) in testbench</td>
<td>❌ 不可综合</td>
<td>可在 testbench 中使用（等待触发事件）</td>
</tr>
<tr>
<td>forever / repeat</td>
<td>❌ 不可综合</td>
<td>仅限 testbench，无法静态展开</td>
</tr>
<tr>
<td>real 类型变量</td>
<td>❌ 不可综合</td>
<td>综合工具不支持浮点数硬件建模</td>
</tr>
<tr>
<td>task</td>
<td>❌ 不可综合</td>
<td>通常用于 testbench 中行为级建模</td>
</tr>
<tr>
<td>fork / join</td>
<td>❌ 不可综合</td>
<td>并发控制语句，仅限仿真</td>
</tr>
<tr>
<td>disable</td>
<td>❌ 不可综合</td>
<td>控制仿真流程使用</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>

<h2 id="verilog_3">十、Verilog代码编写常见问题</h2>
<ol>
<li>
<p>尽量使用==一个时钟==，或者==同一个时钟源==的时钟。<br />
<br></p>
</li>
<li>
<p>在设计中，使用==一个时钟沿==工作：<br />
<img alt="" src="../Study_notes_material/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/%E6%97%B6%E9%92%9F%E6%B2%BF.png" /><br />
<br></p>
</li>
<li>
<p>在电路设计中要求有一个初始态，在电路工作前初始化所有的寄存器（<mark>组合逻辑的输入可以溯源自寄存器的输出</mark>）。<br />
推荐异步清零，同步清零清的比较慢<br />
<br></p>
</li>
<li>
<p>在设计中，尽量将时序逻辑和组合逻辑分在不同的过程块中描述。<br />
<br></p>
</li>
<li>
<p>Latch的推断:</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>代码问题</th>
<th>是否会推导 Latch</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>if</code> / <code>case</code> 不完整覆盖所有条件</td>
<td>✅ 会</td>
<td>综合器认为需要记忆 → 推导 latch（<mark>加上else和default</mark>）</td>
</tr>
<tr>
<td>对变量的赋值在 <code>if</code> / <code>case</code> 语句中遗漏</td>
<td>✅ 会</td>
<td>综合器认为某些条件下值应保持不变</td>
</tr>
<tr>
<td>使用电平敏感触发（如 <code>always @(enable)</code>）</td>
<td>✅ 会</td>
<td>电平敏感等效于 latch(<mark>尽量用always(@)</mark>)</td>
</tr>
<tr>
<td>忘记默认赋值</td>
<td>✅ 会</td>
<td>没有默认赋值的组合逻辑，部分路径未定义</td>
</tr>
</tbody>
</table>
<ol>
<li>常量<br />
<img alt="" src="../Study_notes_material/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/%E5%B8%B8%E9%87%8F.png" /></li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.top", "header.autohide", "navigation.indexes", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../javascripts/extra.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
    
  </body>
</html>